{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 190, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/claimCare/src/ai/genkit.ts"],"sourcesContent":["import {genkit} from 'genkit';\nimport {googleAI} from '@genkit-ai/google-genai';\n\nexport const ai = genkit({\n  plugins: [googleAI()],\n  model: 'googleai/gemini-2.5-flash',\n});\n"],"names":[],"mappings":";;;;AAAA;AAAA;AACA;AAAA;;;AAEO,MAAM,KAAK,IAAA,iJAAM,EAAC;IACvB,SAAS;QAAC,IAAA,yLAAQ;KAAG;IACrB,OAAO;AACT"}},
    {"offset": {"line": 210, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/claimCare/src/ai/flows/analyze-medical-bill-for-errors.ts"],"sourcesContent":["\n'use server';\n\n/**\n * @fileOverview Analyzes a medical bill for potential errors and overcharges.\n *\n * - analyzeMedicalBillForErrors - A function that handles the analysis process.\n * - analyzeMedicalBillForErrorsInput - The input type for the analyzeMedicalBillForErrors function.\n * - analyzeMedicalBillForErrorsOutput - The return type for the analyzeMedicalBillForErrors function.\n */\n\nimport {ai} from '../../ai/genkit';\nimport {z} from 'genkit';\n\nconst AnalyzeMedicalBillForErrorsInputSchema = z.object({\n  billText: z\n    .string()\n    .optional()\n    .describe('The text extracted from the medical bill to be analyzed.'),\n  imageData: z\n    .string()\n    .optional()\n    .nullable()\n    .describe(\"An image of a medical bill, as a data URI that must include a MIME type and use Base64 encoding. Expected format: 'data:<mimetype>;base64,<encoded_data>'.\"),\n  insurancePdfData: z\n    .string()\n    .optional()\n    .nullable()\n    .describe(\"A PDF of the user's insurance Summary of Benefits and Coverage (SBC), as a data URI.\"),\n});\nexport type AnalyzeMedicalBillForErrorsInput = z.infer<\n  typeof AnalyzeMedicalBillForErrorsInputSchema\n>;\n\nconst AnalyzeMedicalBillForErrorsOutputSchema = z.object({\n  analysisMarkdown: z\n    .string()\n    .describe(\n      'A markdown table with columns for \"Line Item\", \"Potential Issue\", and \"Estimated Savings\".'\n    ),\n    discrepancyDetails: z.object({\n        patientName: z.string().optional().describe(\"The patient's name, if found.\"),\n        expectedAmount: z.string().optional().describe(\"The expected co-pay or cost.\"),\n        billedAmount: z.string().optional().describe(\"The amount that was actually billed or paid at the point of sale.\"),\n        planReference: z.string().optional().describe(\"The page or section in the SBC for reference.\"),\n    }).optional().describe(\"Details of any point-of-sale discrepancy found.\"),\n  logicTrace: z.array(z.string()).optional().describe(\"An array of strings, where each string is a detailed explanation of the reasoning for flagging a potential issue.\"),\n});\nexport type AnalyzeMedicalBillForErrorsOutput = z.infer<\n  typeof AnalyzeMedicalBillForErrorsOutputSchema\n>;\n\nexport async function analyzeMedicalBillForErrors(\n  input: AnalyzeMedicalBillForErrorsInput\n): Promise<AnalyzeMedicalBillForErrorsOutput> {\n  return analyzeMedicalBillForErrorsFlow(input);\n}\n\nconst prompt = ai.definePrompt({\n  name: 'analyzeMedicalBillForErrorsPrompt',\n  input: {schema: AnalyzeMedicalBillForErrorsInputSchema},\n  output: {schema: AnalyzeMedicalBillForErrorsOutputSchema},\n  prompt: `You are a professional medical billing auditor expert.\n\nBefore you start the audit, scan the text for any Patient Names, Birthdays, SSNs, or Member IDs. If you find them, immediately replace them with [REDACTED] in your internal processing and never show them in the final output. Only focus on the CPT codes, descriptions, and prices.\n\nIf you see a Name, Phone Number, or SSN in the bill, DO NOT include them in the audit results. Only use the medical codes and prices.\nAnalyze this image of a medical bill or the provided text. Extract all line items and then perform an audit.\n\nFor every single error you find, you MUST include a 'Logic Trace' entry in the output metadata. This is a justification for your finding.\nExample Logic Trace: 'Flag: Unbundling. Reason: CPT 12001 (simple repair) is an integral component of CPT 19301 (mastectomy) per NCCI Procedure-to-Procedure (PTP) edits. Reference: National Correct Coding Initiative guidelines.'\n\n{{#if insurancePdfData}}\nYou are in 'Advocate Mode'. A PDF of the user's insurance Summary of Benefits and Coverage (SBC) has been provided. You MUST cross-reference the bill against the SBC's 'Patient Responsibility' section (Deductibles, Co-pays, Co-insurance, etc.).\n\nYour primary goal is to find discrepancies where the patient was charged more than their responsibility outlined in the SBC. If you find such a discrepancy, you MUST begin your response with the line: '### Point-of-Sale Discrepancy Found!'.\n\nIn addition to the markdown table, you MUST populate the 'discrepancyDetails' object. Extract the patient's name if available (otherwise use \"the patient\"). Extract the specific expected cost (e.g., \"$20.00 Co-pay\") from the SBC, the amount the patient was actually billed from the medical bill, and the page number or section of the SBC that confirms this (e.g., \"Page 4, Co-payment section\").\n\nWhen describing the issue in the markdown table, you MUST quote the relevant text from the SBC PDF as evidence.\nExample: 'Discrepancy found. Bill charges $100. SBC (Page 4, Section \"Specialist Visit\") states: \"Co-payment: $50.00\".'\n\nThen, provide the standard markdown table, detailing the specific line items that conflict with the SBC.\n{{else}}\nYou are in 'Standard Audit' mode. No insurance summary was provided. Perform a 'Standard Audit' based on your knowledge of common medical billing practices.\n\nWhen you audit, look for the following:\n1. Upcoding (billing for a more complex service than provided)\n2. Unbundling (separating services that should be one code)\n3. Duplicate charges\n{{/if}}\n\nReturn the results in a clean Markdown table with columns for 'Line Item', 'Potential Issue', and 'Estimated Savings'.\n\n{{#if billText}}\nMedical Bill Text:\n{{{billText}}}\n{{/if}}\n\n{{#if imageData}}\nMedical Bill Image:\n{{media url=imageData}}\n{{/if}}\n\n{{#if insurancePdfData}}\nInsurance Summary PDF:\n{{media url=insurancePdfData}}\n{{/if}}\n`,\n});\n\nconst analyzeMedicalBillForErrorsFlow = ai.defineFlow(\n  {\n    name: 'analyzeMedicalBillForErrorsFlow',\n    inputSchema: AnalyzeMedicalBillForErrorsInputSchema,\n    outputSchema: AnalyzeMedicalBillForErrorsOutputSchema,\n  },\n  async input => {\n    const {output} = await prompt(input, {\n      config: {\n        temperature: 0,\n        topP: 0.1,\n      }\n    });\n    if (!output) {\n      return { analysisMarkdown: \"No analysis could be performed.\" };\n    }\n    \n    // A simple check to see if the output looks like a table.\n    // If not, we can provide a default message.\n    if (!output.analysisMarkdown.includes('|') && !output.discrepancyDetails) {\n       return { analysisMarkdown: \"No obvious errors or overcharges were found in the provided bill. For a more thorough review, consider consulting a professional medical bill auditor.\" };\n    }\n\n    return output;\n  }\n);\n"],"names":[],"mappings":";;;;;AAGA;;;;;;CAMC,GAED;AACA;AAAA;;;;;AAEA,MAAM,yCAAyC,4IAAC,CAAC,MAAM,CAAC;IACtD,UAAU,4IAAC,CACR,MAAM,GACN,QAAQ,GACR,QAAQ,CAAC;IACZ,WAAW,4IAAC,CACT,MAAM,GACN,QAAQ,GACR,QAAQ,GACR,QAAQ,CAAC;IACZ,kBAAkB,4IAAC,CAChB,MAAM,GACN,QAAQ,GACR,QAAQ,GACR,QAAQ,CAAC;AACd;AAKA,MAAM,0CAA0C,4IAAC,CAAC,MAAM,CAAC;IACvD,kBAAkB,4IAAC,CAChB,MAAM,GACN,QAAQ,CACP;IAEF,oBAAoB,4IAAC,CAAC,MAAM,CAAC;QACzB,aAAa,4IAAC,CAAC,MAAM,GAAG,QAAQ,GAAG,QAAQ,CAAC;QAC5C,gBAAgB,4IAAC,CAAC,MAAM,GAAG,QAAQ,GAAG,QAAQ,CAAC;QAC/C,cAAc,4IAAC,CAAC,MAAM,GAAG,QAAQ,GAAG,QAAQ,CAAC;QAC7C,eAAe,4IAAC,CAAC,MAAM,GAAG,QAAQ,GAAG,QAAQ,CAAC;IAClD,GAAG,QAAQ,GAAG,QAAQ,CAAC;IACzB,YAAY,4IAAC,CAAC,KAAK,CAAC,4IAAC,CAAC,MAAM,IAAI,QAAQ,GAAG,QAAQ,CAAC;AACtD;AAKO,eAAe,4BACpB,KAAuC;IAEvC,OAAO,gCAAgC;AACzC;AAEA,MAAM,SAAS,yHAAE,CAAC,YAAY,CAAC;IAC7B,MAAM;IACN,OAAO;QAAC,QAAQ;IAAsC;IACtD,QAAQ;QAAC,QAAQ;IAAuC;IACxD,QAAQ,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8CX,CAAC;AACD;AAEA,MAAM,kCAAkC,yHAAE,CAAC,UAAU,CACnD;IACE,MAAM;IACN,aAAa;IACb,cAAc;AAChB,GACA,OAAM;IACJ,MAAM,EAAC,MAAM,EAAC,GAAG,MAAM,OAAO,OAAO;QACnC,QAAQ;YACN,aAAa;YACb,MAAM;QACR;IACF;IACA,IAAI,CAAC,QAAQ;QACX,OAAO;YAAE,kBAAkB;QAAkC;IAC/D;IAEA,0DAA0D;IAC1D,4CAA4C;IAC5C,IAAI,CAAC,OAAO,gBAAgB,CAAC,QAAQ,CAAC,QAAQ,CAAC,OAAO,kBAAkB,EAAE;QACvE,OAAO;YAAE,kBAAkB;QAAyJ;IACvL;IAEA,OAAO;AACT;;;IAnFoB;;AAAA,+OAAA"}},
    {"offset": {"line": 336, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/claimCare/src/app/actions.ts"],"sourcesContent":["\"use server\";\n\nimport { analyzeMedicalBillForErrors, AnalyzeMedicalBillForErrorsInput, AnalyzeMedicalBillForErrorsOutput } from '../ai/flows/analyze-medical-bill-for-errors';\n\nexport async function analyzeBill(input: AnalyzeMedicalBillForErrorsInput): Promise<{ \n  success: true; \n  data: AnalyzeMedicalBillForErrorsOutput;\n  hasOvercharge: boolean; // Add this to help the frontend\n} | { success: false; error: string }> {\n  \n  if (!input.billText?.trim() && !input.imageData) {\n    return { success: false, error: \"Please provide either bill text or an image of the bill.\" };\n  }\n  \n  if (input.billText && input.billText.trim().length < 20) {\n     return { success: false, error: \"Please provide more detailed bill text for an accurate analysis.\" };\n  }\n\n  try {\n    console.log(\"AI Input Text:\", input.billText); \n    \n    const result = await analyzeMedicalBillForErrors(input);\n    \n    console.log(\"AI Output Result:\", JSON.stringify(result, null, 2));\n\n    // âœ… LOGIC FIX: Determine if an overcharge exists based on logicTrace entries\n    const hasOvercharge = !!(result.logicTrace && result.logicTrace.length > 0);\n\n    return { \n      success: true, \n      data: result,\n      hasOvercharge: hasOvercharge // Pass this flag to your UI\n    };\n  } catch (e: any) {\n    console.error(e);\n    const errorMessage = e.message || \"An unexpected error occurred during analysis.\";\n    return { success: false, error: errorMessage };\n  }\n}"],"names":[],"mappings":";;;;;AAEA;;;;AAEO,eAAe,YAAY,KAAuC;IAMvE,IAAI,CAAC,MAAM,QAAQ,EAAE,UAAU,CAAC,MAAM,SAAS,EAAE;QAC/C,OAAO;YAAE,SAAS;YAAO,OAAO;QAA2D;IAC7F;IAEA,IAAI,MAAM,QAAQ,IAAI,MAAM,QAAQ,CAAC,IAAI,GAAG,MAAM,GAAG,IAAI;QACtD,OAAO;YAAE,SAAS;YAAO,OAAO;QAAmE;IACtG;IAEA,IAAI;QACF,QAAQ,GAAG,CAAC,kBAAkB,MAAM,QAAQ;QAE5C,MAAM,SAAS,MAAM,IAAA,gMAA2B,EAAC;QAEjD,QAAQ,GAAG,CAAC,qBAAqB,KAAK,SAAS,CAAC,QAAQ,MAAM;QAE9D,6EAA6E;QAC7E,MAAM,gBAAgB,CAAC,CAAC,CAAC,OAAO,UAAU,IAAI,OAAO,UAAU,CAAC,MAAM,GAAG,CAAC;QAE1E,OAAO;YACL,SAAS;YACT,MAAM;YACN,eAAe,cAAc,4BAA4B;QAC3D;IACF,EAAE,OAAO,GAAQ;QACf,QAAQ,KAAK,CAAC;QACd,MAAM,eAAe,EAAE,OAAO,IAAI;QAClC,OAAO;YAAE,SAAS;YAAO,OAAO;QAAa;IAC/C;AACF;;;IAlCsB;;AAAA,+OAAA"}},
    {"offset": {"line": 387, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/claimCare/.next-internal/server/app/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {analyzeBill as '40870b6df25011e5fed858ff2dcc00a093584db50d'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA"}}]
}